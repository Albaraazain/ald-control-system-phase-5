{"timestamp": "2025-09-20T17:53:44.713335", "agent_id": "investigator-175105-96bd09", "finding_type": "issue", "severity": "critical", "message": "stopper.update_process_status rejects 'stopped' but stop_recipe uses it, preventing machine reset to idle.", "data": {"file": "src/recipe_flow/stopper.py", "usage_line": 42, "allowed_statuses_lines": "9-11,55-58", "details": "PROCESS_STATUSES=('preparing','running','paused','completed','failed','aborted'); stop_recipe calls update_process_status(process_id, 'stopped'), which raises ValueError and aborts subsequent machine status/state updates."}}
{"timestamp": "2025-09-20T17:53:53.433106", "agent_id": "investigator-175105-96bd09", "finding_type": "issue", "severity": "high", "message": "Conflicting function names with different signatures: update_machine_status and update_machine_state defined in both starter.py and stopper.py.", "data": {"starter": "src/recipe_flow/starter.py:173-192 (update_machine_status(status, process_id=None)); 194-218 (update_machine_state(state, process_id=None))", "stopper": "src/recipe_flow/stopper.py:78-95 (update_machine_status(process_id)); 97-117 (update_machine_state(process_id))", "risk": "Imports may refer to unexpected version; future refactors likely to miscall; inconsistent signature encourages misuse."}}
{"timestamp": "2025-09-20T17:54:00.904654", "agent_id": "investigator-175105-96bd09", "finding_type": "issue", "severity": "high", "message": "start_recipe can leave machine stuck in 'processing' if an exception occurs after setting status/state but before execute_recipe runs.", "data": {"file": "src/recipe_flow/starter.py", "lines": "109-116,118-121", "details": "Machine status and state are set to 'processing' (lines 109-113) before starting recorder (line 116) and executing recipe (line 119). If recorder start fails or any error occurs before execute_recipe handles errors, there is no local rollback to idle/error; exception propagates to process_command which marks command ERROR but machine remains 'processing'."}}
{"timestamp": "2025-09-20T17:54:06.483576", "agent_id": "investigator-175105-96bd09", "finding_type": "insight", "severity": "low", "message": "Error and completion paths correctly update both machines.status and machine_state.current_state.", "data": {"complete_recipe": "src/recipe_flow/executor.py:168-201 sets process_executions.status='completed', machines.status='idle', machine_state.current_state='idle'", "handle_recipe_error": "src/recipe_flow/executor.py:219-246 sets process_executions.status='failed', machines.status='error', machine_state.current_state='error', is_failure_mode=True"}}
{"timestamp": "2025-09-20T18:00:29.890224", "agent_id": "investigator-175105-96bd09", "finding_type": "issue", "severity": "high", "message": "stop_recipe calls update_process_status(process_id, 'stopped'), but allowed PROCESS_STATUSES excludes 'stopped', causing ValueError and preventing machine status/state from being reset to idle.", "data": {"file": "src/recipe_flow/stopper.py", "lines": {"call": "42-49", "enum": "10-12", "validator": "57-60"}}}
